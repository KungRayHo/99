<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>
    <h2 align=center>魔幻方格</h2>
    <hr>
    <script>
        n = new Array()
        a = new Array()
        for (i = 1; i <= 25; i++) {
            a.push(i)
        }
        var ch = false
        while (ch == false) {
            for (i = 0; i <= 24; i++) {
                index = Math.floor(Math.random() * a.length)
                n[i] = a[index]
                a.splice(index, 1);
            }
            ch = check()
        }

        function check() {
            c = [
                [],
                [],
                [],
                [],
                []
            ]
            for (i = 0; i <= 4; i++) {
                for (j = 0; j <= 4; j++) {
                    c[i, j] = n[i * 5 + j]
                }
            }
            for (i = 0; i <= 4; i++) {
                var row = 0
                for (j = 0; j <= 4; j++) {
                    row += c[i, j]
                }
                if (row != 65) {
                    return false
                }
            }
            for (i = 0; i <= 4; i++) {
                var row = 0
                for (j = 0; j <= 4; j++) {
                    row += c[j, i]
                }
                if (row != 65) {
                    return false
                }
            }
            if (c[0, 0] + c[1, 1] + c[2, 2] + c[3, 3] + c[4, 4] + c[5, 5] == c[0, 4] + c[1, 3] + c[2, 2] + c[3, 1] + c[4, 0]) {
                return false
            } else {
                return true
            }
        }
        document.write("<center>")
        document.write("<table border=1 >")
        document.writeln("<tr><td>" + n[0] + "<td>" + n[1] + "<td>" + n[2] + "<td>" + n[3] + "<td>" + n[4])

        for (i = 5; i <= 20;) {
            document.writeln("<tr><td>" + n[i] + "<td>" + n[i + 1] + "<td>" + n[i + 2] + "<td>" + n[i + 3] + "<td>" + n[i + 4])
            i += 5
        }
        document.write("</table>")
        document.write("</center>")
    </script>
</body>

</html>